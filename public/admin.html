<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Admin Panel</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: Arial, sans-serif; background:#f0f2f5; margin:0; }
    header { background:#333; color:#fff; padding:15px; text-align:center; font-size:22px; }
    .container { padding:20px; }
    .controls { margin-bottom:15px; display:flex; justify-content:space-between; align-items:center; }
    input[type="text"] { padding:8px; width:250px; border-radius:5px; border:1px solid #ccc; }
    select { padding:8px; border-radius:5px; border:1px solid #ccc; }
    table { width:100%; border-collapse:collapse; background:white; border-radius:6px; overflow:hidden; }
    th, td { border-bottom:1px solid #ddd; padding:12px; text-align:center; }
    th { background:#444; color:white; }
    tr:hover { background:#f9f9f9; }
    button { margin:2px; padding:5px 10px; border:none; border-radius:5px; cursor:pointer; }
    .approve { background:green; color:white; }
    .block { background:red; color:white; }
    .unblock { background:orange; color:white; }
    .delete { background:black; color:white; }
    footer { text-align:center; padding:10px; margin-top:20px; color:#555; }
  </style>
</head>
<body>
  <header>âš¡ Admin Panel âš¡</header>
  <div class="container">

    <!-- Search + Filter -->
    <div class="controls">
      <input type="text" id="searchBox" placeholder="ðŸ” Search UserID...">
      <select id="filterStatus">
        <option value="">All Status</option>
        <option value="approved">Approved</option>
        <option value="blocked">Blocked</option>
        <option value="pending">Pending</option>
      </select>
    </div>

    <!-- Users Table -->
    <table id="userTable">
      <thead>
        <tr>
          <th>UserID</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
  <footer>Â© 2025 | Admin Panel | Connected to Server.js</footer>

  <script>
    let users = [];

    async function loadUsers() {
      const res = await fetch("/api/admin/users");
      users = await res.json();
      renderTable();
    }

    function renderTable() {
      const search = document.getElementById("searchBox").value.toLowerCase();
      const filter = document.getElementById("filterStatus").value;
      const tbody = document.querySelector("#userTable tbody");
      tbody.innerHTML = "";

      users
        .filter(u => (!filter || u.status === filter))
        .filter(u => u.userId.toLowerCase().includes(search))
        .forEach(u => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${u.userId}</td>
            <td>${u.status}</td>
            <td>
              <button class="approve" onclick="action('approve','${u.userId}')">Approve</button>
              <button class="block" onclick="action('block','${u.userId}')">Block</button>
              <button class="unblock" onclick="action('unblock','${u.userId}')">Unblock</button>
              <button class="delete" onclick="action('delete','${u.userId}')">Delete</button>
            </td>
          `;
          tbody.appendChild(tr);
        });
    }

    async function action(type, id) {
      let url = `/api/admin/${type}/${id}`;
      let options = { method: "POST" };
      if (type === "delete") options.method = "DELETE";
      await fetch(url, options);
      loadUsers();
    }

    document.getElementById("searchBox").addEventListener("input", renderTable);
    document.getElementById("filterStatus").addEventListener("change", renderTable);

    loadUsers();
    setInterval(loadUsers, 8000); // auto refresh
  </script>
</body>
</html>
